<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
  PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
  "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
  
<mapper namespace="com.yonseidairy.site.mapper.AddressMapper">

    <select id="selectAllRegionsForAddress" resultType="RegionDao">
        SELECT
	      A.CUSTNO AS code,
	      A.CUSTNAME AS name,
	      A.POLYGON_COORDS,
	      B.ADDR AS addr,
	      B.ADDR_1 AS gubun,
	      B.PHONE_MOBILE1 AS tel
	    FROM
	      REGION_LOCATION A,
	      CD_CUSTOMER B
	    WHERE
	      B.OFFICE_ID = 'YSM'
	      AND A.CUSTNO = B.CUSTNO
	      AND A.GUBUN_TYPE = '10'
    </select>
    
    <select id="selectInfoByCustno" parameterType="InfoByCustnoDao" resultType="InfoByCustnoDao">
        SELECT
           a.custno as custno
	       , a.custname as custname
	       , a.addr as addr
	       , a.addr_1 AS gubun
	       , NVL(a.tel, a.phone_mobile1) AS tel
	       , apps.f_get_cmetc_name(a.office_id, 'BNKCDE', MAX(DECODE(b.seq, 1, b.bnk_cde))) AS bnk_nme1
	       , MAX(DECODE(b.seq, 1, b.acct_nbr)) AS acct_nbr1
	       , MAX(DECODE(b.seq, 1, b.remark))   AS remark1
	       , apps.f_get_cmetc_name(a.office_id, 'BNKCDE', MAX(DECODE(b.seq, 2, b.bnk_cde))) AS bnk_nme2
	       , MAX(DECODE(b.seq, 2, b.acct_nbr)) AS acct_nbr2
	       , MAX(DECODE(b.seq, 2, b.remark))   AS remark2
	     FROM apps.cd_customer a, apps.cd_customer_acct_nbr b
	     WHERE a.office_id = 'YSM'
	        AND a.custno = #{custno,jdbcType=VARCHAR}
	        AND a.custno = b.custno
	     GROUP BY
	         a.office_id
	       , a.custno
	       , a.custname
	       , a.addr
	       , a.addr_1
	       , NVL(a.tel, a.phone_mobile1)
    </select>
    
    <select id="selectCustnoList" resultType="InfoByCustnoDao">
        SELECT custno, custname FROM apps.cd_customer a
        WHERE office_id = 'YSM' AND use_yno = 'Y' AND HANDLE = '10'
        AND exists ( select 1 from sale.sasaltyp where office_id = a.office_id and org_id = 'MHD' and custno = a.custno and sale_type = '01' and use_yno = 'Y')
        ORDER BY custname
    </select>
    
    <insert id="insertColdChainData" parameterType="ColdChainDao">
	    INSERT INTO COLD_CHAIN_DATA (
	        VENDOR_DEVICE_ID
	        , INTERVAL
	        , PARTNER_ID
	        , DATE_VAL
	        , TIME_VAL
	        , VENDOR_ID
	        , TEMP
	        , HUMIDITY
	        , LIGHT
	        , DOOR_STATUS
	        , SHOCK
	        , AXIS_X
	        , AXIS_Y
	        , AXIS_Z
	        , TIMESTAMP_VAL
	        , VOLTAGE
	        , DEVICE_TYPE
	        , GPS_LNG
	        , GPS_LAT
	        , GPS_VALID
	        , DEVICE_ID
	        , REF_TYPE
	        , DEVICE_ALIAS
	        , INSERT_DATE
	    ) VALUES (
	        #{vendorDeviceId,jdbcType=VARCHAR},
	        #{interval,jdbcType=INTEGER},
	        #{partnerId,jdbcType=VARCHAR},  
	        #{date,jdbcType=VARCHAR},
	        #{time,jdbcType=VARCHAR},
	        #{vendorId,jdbcType=VARCHAR},
	
	        #{temparature,jdbcType=NUMERIC},
	        #{humidity,jdbcType=NUMERIC},
	        #{light,jdbcType=NUMERIC},
	        #{door,jdbcType=VARCHAR},
	        #{shock,jdbcType=NUMERIC},
	
	        #{xaxis,jdbcType=NUMERIC},
	        #{yaxis,jdbcType=NUMERIC},
	        #{zaxis,jdbcType=NUMERIC},
	
	        #{timestamp,jdbcType=VARCHAR},
	        #{voltage,jdbcType=VARCHAR},
	        #{deviceType,jdbcType=VARCHAR},
	
	        #{longitude,jdbcType=NUMERIC},
	        #{latitude,jdbcType=NUMERIC},
	        #{isValid,jdbcType=VARCHAR},
	
	        #{deviceId,jdbcType=VARCHAR},
	        #{refType,jdbcType=VARCHAR},
	        #{deviceAlias,jdbcType=VARCHAR},
	        SYSDATE
	    )
	  </insert>

</mapper>